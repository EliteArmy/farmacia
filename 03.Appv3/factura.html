<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Facturación</title>
  <link rel="icon" href="./img/icon.png">
  <link rel="stylesheet" href="./css/bootstrap.min.css">
  <link rel="stylesheet" href="./css/jquery-confirm.min.css">
  <link rel="stylesheet" href="./css/style.css">
</head>
<body class="root">
    <!-- ************************************************ BARRA NAVEGACION -->
    <nav class="navbar navbar-default navbar-fixed-top" id="nav"></nav>

  <!-- *************************************  CONTENIDO  ******************************-->

  <div class="container-fluid" id="app">
    <div class="well card info">
      <div class="row">
        <div class="col-lg-12 cabecera-factura">
          <h4 class="titulo">{{farmacia.nombre}}</h4>
          <h4>{{farmacia.direccion}}</h4>
          <h4>RTN: {{farmacia.rtn}}</h4>
          <!-- <h4>Factura No. {{numeroFactura}}</h4> -->
        </div>
      </div>
      <div class="row">
        <div class="col-lg-12">
          <table class="table table-responsive">
            <tr>
              <td class="etiqueta">Cliente: </td>
              <td class="input-group">
                <input type="text" v-model="cliente.nombre" placeholder="Cliente" class="form-control">
                <span class="input-group-btn">
                  <button type="button" class="btn btn-success" data-toggle="modal" data-target="#modal-cliente">Buscar</button>
                </span>
              </td>
              <td class="etiqueta">Teléfono: </td>
              <td>
                <input type="text" v-model="cliente.telefono" placeholder="Teléfono" class="form-control">
              </td>
              <td class="etiqueta">RTN: </td>
              <td class="input-group">
                <input type="text" v-model="cliente.rtn" placeholder="RTN" class="form-control" :disabled="!necesitaRTN">
                <span class="input-group-addon"><input type="checkbox" v-model="necesitaRTN"></span>
              </td>
            </tr>
            <tr>
              <td class="etiqueta">Vendedor: </td>
              <td>
                <input type="tel" name="" :value="vendedor.nombre" disabled="disabled" class="form-control">
              </td>
              <td class="etiqueta">Fecha: </td>
              <td>
                <input type="date"  :value="fecha" disabled="disabled" class="form-control">
              </td>
              <td class="etiqueta">Hora: </td>
              <td>
                <input type="time"  :value="hora" disabled="disabled" class="form-control">
              </td>
            </tr>
            <tr>
              <td class="etiqueta">Forma Pago: </td>
              <td><select class="form-control">
                <option v-for="f of listadoFormaPago" value="f.id">{{f.descripcion}}</option>
              </select>
              </td>
            </tr>
          </table>
        </div>
      </div>

      <div class="row">
        <h4 class="titulo">Detalle</h4>
        <div class="col-lg-12">
          <table class="table table-striped table-responsive">
            <thead>
              <th>Código</th>
              <th>Cant.</th>
              <th>Descripción</th>
              <th>Precio Unitario</th>
              <th>Impuesto (ISV)</th>
              <th>Sub Total</th>
              <th>Descuento (%)</th>
              <th>Precio Total</th>
              <th></th>
            </thead>
            <tbody>
              <tr v-for="(p, i) of productos">
                <td>{{p.codigo}}</td>
                <td><input type="number" :value="p.cantidad" v-model="p.cantidad" min="1" max="999" size="3" class="form-control cantidad"></td>
                <td>{{p.descripcion}}</td>
                <td class="td-dinero">L.{{p.precio.toFixed(2)}}</td>
                <td>L. {{getImpuesto(p)}} ({{printImpuesto(p)}})</td>
                <td class="td-dinero">L. {{getSubTotal(p)}}</td>
                <td class="td-descuento">{{getDescuento(p)}}</td>
                <td class="td-dinero">L.{{getTotal(p)}}</td>
                <td><button type="button" v-on:click="remover(i)" class="btn btn-xs btn-default"><span class="glyphicon glyphicon-trash"></span></button></td>
              </tr>
              <tfoot>
                <tr>
                  <td colspan="5" class="total">SubTotal</td>
                  <td class="td-dinero">L. {{subTotalFactura}}</td>
                </tr>
                <tr v-for="isv of isvTotales">
                  <td colspan="5" class="total">ISV{{Math.round(isv.porcentaje * 100)}}%</td>
                  <td>L. {{isv.valor}}</td>
                </tr>
                <tr>
                  <td colspan="5" class="total">Total Descuento</td>
                  <td class="td-descuento">L. {{descuentoTotal}}</td>
                </tr>
                <tr>
                  <td colspan="5" class="total">Total</td>
                  <td class="td-dinero" >L. {{totalFactura}}</td>
                </tr>
              </tfoot>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    
    <!-- FAB ICON -->
    <div class="container fab">
      <div class="row">
        <div class="col-lg-12">
          <a href="#" data-toggle="modal" data-target="#modal-cliente" class="btn btn-success"><span class="glyphicon glyphicon-plus"></span> Agregar Producto</a>
        </div>
      </div>
    </div>
    <!-- /FAB ICON -->

    <!-- Modal -->
    <div class="modal fade" id="modal-cliente" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title titulo" id="myModalLabel">Buscar cliente</h4>
          </div>
          <div class="modal-body">
            <table class="table table-responsive">
              <tr>
                <td><input type="text" id="txt-busqueda-cliente" value="" placeholder="Cliente" class="form-control"></td>
                <td>
                  <select id="criterio-busqueda" class="form-control">
                    <option value="3">Nombre</option>
                    <option value="1">Número Cliente</option>
                    <option value="4">Identidad</option>
                  </select>
                </td>
                <td><button type="button" class="btn btn-default" v-on:click = "limpiarBusqueda()" >Limpiar</button>
                <button type="button" class="btn btn-primary" v-on:click = "buscarClientes()" >Buscar</button></td>
              </tr>
            </table>
            <h4>Resultados</h4>
            <table class="table table-striped table-responsive">
              <thead>
                <th></th>
                <th>No Cliente</th>
                <th>Nombre</th>
                <th>No Identidad</th>
                <th>Teléfono(s)</th>
              </thead>
              <tbody>
                <tr v-for ="c of listadoClientes">
                  <td><input type="radio" v-bind:id="'rbt'+c.id_cliente" name="rbt-id-cliente" :value="c.id_cliente"></td>
                  <td>{{c.id_cliente}}</td>
                  <td><label v-bind:for="'rbt'+c.id_cliente"> {{c.nombre_completo}} </label></td>
                  <td><label v-bind:for="'rbt'+c.id_cliente"> {{formatIdentidad(c.numero_identidad)}} </label></td>
                  <td><label v-bind:for="'rbt'+c.id_cliente"> {{c.telefonos}} </label></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" v-on:click="limpiarBusqueda()" data-dismiss="modal">Cancelar</button>
            <button type="button" class="btn btn-success" v-on:click="seleccionarCliente()">Aceptar</button>
          </div>
        </div>
      </div>
    </div>

  </div>

</body>
<script src="./js/jquery.min.js"></script>
<script src="./js/jquery-confirm.min.js"></script>
<script src="./js/bootstrap.min.js"></script>
<script src="./js/vue.min.js"></script>
<script src="./js/config.js"></script>
<script src="./js/nav.js"></script>
<script src="./js/controller/factura.js"></script>
<script>
  
</script>
</html>

